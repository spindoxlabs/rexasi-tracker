import os
import sys

import numpy as np

sys.path.append(os.getcwd())
from rexasi_tracker.utils.dto import SensorData, CenterData, Keypoints

TEST_BACKPROJECT_DATA = {
    1: [[373, 419, 0, 2], [524, 337, 1, 4], [304, 335, -1, 4]],
    2: [],  # no data for this test!
}

TEST_TOPIC_DATA = SensorData(
    frame_number=-1,
    idx=2,
    timestamp=1698228024060782336,
    detections=Keypoints(
        pixels=[
            [
                [0.0, 0.0, 0.021351663395762444],
                [0.0, 0.0, 0.0044236332178115845],
                [0.0, 0.0, 0.005917715840041637],
                [0.0, 0.0, 0.1713148057460785],
                [0.0, 0.0, 0.2910626232624054],
                [656.537353515625, 24.306352615356445, 0.9529252648353577],
                [740.0988159179688, 20.586380004882812, 0.9467601180076599],
                [634.1939697265625, 109.31339263916016, 0.9403204321861267],
                [767.1807250976562, 78.79139709472656, 0.9209358096122742],
                [639.4810180664062, 172.1637420654297, 0.8789117336273193],
                [755.9224853515625, 109.92163848876953, 0.8500248789787292],
                [679.0936889648438, 164.4197998046875, 0.9978345036506653],
                [738.4656372070312, 167.71328735351562, 0.9974040389060974],
                [680.4419555664062, 269.1398010253906, 0.9976075887680054],
                [772.7689208984375, 284.7426452636719, 0.9972712397575378],
                [638.275634765625, 362.7325744628906, 0.9845216870307922],
                [759.3812255859375, 388.75335693359375, 0.9831207990646362],
            ],
            [
                [444.82049560546875, 168.38864135742188, 0.8149487376213074],
                [446.810302734375, 165.10311889648438, 0.8654646873474121],
                [0.0, 0.0, 0.3808857500553131],
                [454.0561828613281, 165.4590301513672, 0.8984869122505188],
                [0.0, 0.0, 0.10980231314897537],
                [462.53216552734375, 181.62744140625, 0.9914754629135132],
                [456.7314453125, 181.25863647460938, 0.9553405046463013],
                [464.4465637207031, 206.1753692626953, 0.9849236011505127],
                [456.0294189453125, 202.4712677001953, 0.6980220675468445],
                [449.7852478027344, 216.2277069091797, 0.9677472114562988],
                [444.0600891113281, 208.890625, 0.6975760459899902],
                [464.7684631347656, 228.3408660888672, 0.9953374862670898],
                [458.9585266113281, 227.31541442871094, 0.9880937933921814],
                [472.01190185546875, 264.240234375, 0.9940166473388672],
                [448.81939697265625, 263.1297607421875, 0.9808245897293091],
                [483.2767028808594, 298.8581848144531, 0.9862076044082642],
                [440.7986145019531, 296.0057067871094, 0.967231035232544],
            ],
            [
                [0.0, 0.0, 0.20464292168617249],
                [0.0, 0.0, 0.16520941257476807],
                [0.0, 0.0, 0.12791527807712555],
                [42.80653762817383, 298.91998291015625, 0.6187217831611633],
                [0.0, 0.0, 0.4405052363872528],
                [39.264488220214844, 308.3536682128906, 0.970273494720459],
                [55.1097297668457, 308.22247314453125, 0.9623598456382751],
                [34.221229553222656, 318.0733947753906, 0.824831485748291],
                [58.69104766845703, 317.97357177734375, 0.74741131067276],
                [32.80682373046875, 322.1256103515625, 0.6040075421333313],
                [56.8150749206543, 321.9677734375, 0.5167808532714844],
                [41.259029388427734, 330.6929931640625, 0.9571970701217651],
                [51.88850402832031, 330.56378173828125, 0.9523910284042358],
                [37.95335388183594, 344.73541259765625, 0.8436163663864136],
                [52.301795959472656, 344.7947082519531, 0.8256115317344666],
                [38.492435455322266, 357.7611389160156, 0.7131029367446899],
                [53.2674446105957, 357.65374755859375, 0.6927487254142761],
            ],
        ],
        coordinates=[
            [
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [1644.4517822265625, 3020.0, 1524.98583984375],
                [2138.8076171875, 2886.0, 1484.336181640625],
                [np.nan, np.nan, np.nan],
                [1981.7535400390625, 2464.0, 932.8486938476562],
                [1950.80859375, 3865.0, 613.0355834960938],
                [1873.748291015625, 2414.0, 738.7923583984375],
                [1961.9737548828125, 3279.0, 581.4771728515625],
                [1939.7227783203125, 2634.0, 448.6046447753906],
                [2096.99267578125, 3491.0, -238.74139404296875],
                [0.0, 0.0, -0.0],
                [1242.9296875, 2474.0, -707.6298217773438],
                [1589.1907958984375, 2023.0, -701.7218017578125],
            ],
            [
                [np.nan, np.nan, np.nan],
                [396.11907958984375, 7463.0, 1305.9764404296875],
                [np.nan, np.nan, np.nan],
                [520.904296875, 7255.0, 1269.5777587890625],
                [np.nan, np.nan, np.nan],
                [562.4068603515625, 6213.0, 854.599609375],
                [470.7329406738281, 6155.0, 846.6217041015625],
                [683.0699462890625, 7175.0, 567.14892578125],
                [np.nan, np.nan, np.nan],
                [451.09814453125, 7506.0, 417.65716552734375],
                [np.nan, np.nan, np.nan],
                [572.3507690429688, 6012.0, 165.69473266601562],
                [490.2073974609375, 6040.0, 180.60125732421875],
                [707.8037109375, 6213.0, -352.1942138671875],
                [409.8517150878906, 7096.0, -385.6424560546875],
                [828.2150268554688, 5930.0, -807.9837036132812],
                [265.4092102050781, 6799.0, -894.5659790039062],
            ],
            [
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [-0.0, 0.0, -0.0],
                [-1374.7972412109375, 1595.0, -254.6507110595703],
                [-0.0, 0.0, -0.0],
                [-1355.905029296875, 1586.0, -286.61785888671875],
                [np.nan, np.nan, np.nan],
                [np.nan, np.nan, np.nan],
                [-0.0, 0.0, -0.0],
                [-1383.628662109375, 1588.0, -335.29046630859375],
                [-0.0, 0.0, -0.0],
                [-1347.7607421875, 1551.0, -378.29345703125],
                [-0.0, 0.0, -0.0],
                [np.nan, np.nan, np.nan],
            ],
        ],
    ),
    centers=CenterData(
        pixels=[(497, 126), (402, 192), (34, 250)],
        coordinates=[
            (1.4082699560546874, 2.7572315454545455),
            (0.26353742482503256, 6.816527),
            (-0.8732090749782986, 0.8639992222222221),
        ],
    ),
    identities=[1, 2, 3],
    crosses=[[(0, 0)]],
    draw_crosses=True,
)
